å¥½çš„ï¼ŒJoã€‚ä½ è¦ç”¨ AWS Cognito æ¥å®ç° React åº”ç”¨çš„ç”¨æˆ·æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯ä¸€æ­¥æ­¥çš„å…·ä½“æ“ä½œæŒ‡å—ã€‚è¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š

â¸»

ğŸ›  ç¬¬ä¸€éƒ¨åˆ†ï¼šåœ¨ AWS ä¸Šè®¾ç½® Cognito

âœ… 1. åˆ›å»ºä¸€ä¸ª User Pool
	1.	ç™»å½• AWS ç®¡ç†æ§åˆ¶å°
	2.	æœç´¢å¹¶è¿›å…¥ Amazon Cognito
	3.	ç‚¹å‡» â€œCreate user poolâ€ï¼ˆåˆ›å»ºç”¨æˆ·æ± ï¼‰
	4.	é€‰æ‹© â€œFederated identity providersâ€ï¼ˆè”åˆèº«ä»½æä¾›ç¨‹åºï¼‰ â†’ é€‰æ‹© â€œUser poolâ€
	5.	é…ç½®ä»¥ä¸‹é€‰é¡¹ï¼š
	â€¢	User pool name: æ¯”å¦‚ MyAppUserPool
	â€¢	Attributes:
	â€¢	å¯ç”¨ emailï¼ˆæˆ–ç”¨æˆ·åã€æ‰‹æœºå·ç­‰ï¼‰ä½œä¸ºç™»å½•æ–¹å¼
	â€¢	Password policy: è®¾å®šå¯†ç å¼ºåº¦è¦æ±‚
	6.	Self-service sign-upï¼ˆå¯ç”¨ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ï¼‰
	â€¢	æ‰“å¼€ Enable self-registration
	â€¢	é…ç½®é‚®ç®±æˆ–ç”µè¯éªŒè¯ï¼ˆå¯é€‰ï¼‰
	7.	App client è®¾ç½®
	â€¢	åˆ›å»ºä¸€ä¸ªæ–°çš„ App clientï¼Œæ¯”å¦‚ MyAppWebClient
	â€¢	å…³é—­ generate client secretï¼ˆå‰ç«¯ä¸è¦ä½¿ç”¨å¯†é’¥ï¼‰
	8.	ä¿å­˜å¹¶åˆ›å»º User Pool

âœ… 2. è·å–å…³é”®å‚æ•°

è®°å½•ä»¥ä¸‹ä¿¡æ¯ç”¨äºå‰ç«¯è°ƒç”¨ï¼š
é¡¹ç›®
è¯´æ˜
User Pool ID
ä¾‹å¦‚ï¼šap-northeast-1_XXXXXX
App Client ID
ä¾‹å¦‚ï¼š4d8aXXXXXXmql9XXXX
Region
ä¾‹å¦‚ï¼šap-northeast-1
User Pool Domainï¼ˆå¯é€‰ï¼‰
ç”¨äºä½¿ç”¨æ‰˜ç®¡UIç™»å½•æ—¶è®¾ç½®

ç¬¬äºŒéƒ¨åˆ†ï¼šåœ¨ React ä¸­å®ç°æ³¨å†Œå’Œç™»å½•

âœ… 1. å®‰è£… AWS Amplify

npm install aws-amplify

âœ… 2. é…ç½® Amplify

åœ¨ React é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ src/aws-config.jsï¼š
import { Amplify } from 'aws-amplify';

Amplify.configure({
  Auth: {
    region: 'ap-northeast-1',  // æ›¿æ¢ä¸ºä½ çš„åŒºåŸŸ
    userPoolId: 'ap-northeast-1_XXXXXX',  // æ›¿æ¢ä¸ºä½ çš„ User Pool ID
    userPoolWebClientId: '4d8aXXXXXXmql9XXXX',  // æ›¿æ¢ä¸ºä½ çš„ App client ID
  }
});

ç„¶ååœ¨ index.js æˆ– App.js ä¸­å¯¼å…¥ï¼š
import './aws-config';


â¸»
âœ… 3. å®ç°æ³¨å†ŒåŠŸèƒ½
import { Auth } from 'aws-amplify';

async function signUp(username, password, email) {
  try {
    const result = await Auth.signUp({
      username,
      password,
      attributes: {
        email, // å¯é€‰ï¼šemailã€phone_numberç­‰
      }
    });
    console.log('æ³¨å†ŒæˆåŠŸ:', result);
  } catch (error) {
    console.error('æ³¨å†Œå¤±è´¥:', error);
  }
}

âœ… 4. å®ç°ç™»å½•åŠŸèƒ½
async function signIn(username, password) {
  try {
    const user = await Auth.signIn(username, password);
    console.log('ç™»å½•æˆåŠŸ:', user);
  } catch (error) {
    console.error('ç™»å½•å¤±è´¥:', error);
  }
}

å¦‚æœä½ å¸Œæœ›ç”¨ AWS çš„æ‰˜ç®¡ UIï¼ˆæ¯”å¦‚ç¬¬ä¸‰æ–¹ç™»å½•æˆ–é‚®ç®±éªŒè¯ç•Œé¢ï¼‰ï¼Œå¯ä»¥å¯ç”¨ Hosted UIã€‚
	â€¢	å¯ä»¥ä½¿ç”¨ Amplify çš„ @aws-amplify/ui-react æä¾›ç°æˆçš„ç™»å½•ç»„ä»¶ã€‚
	â€¢	åç«¯å¦‚æœç”¨ API Gateway + Lambdaï¼Œå¯ä»¥ç»“åˆ Cognito ç”Ÿæˆçš„ ID Token å®ç°èº«ä»½éªŒè¯ã€‚


å†™ä¸€ä¸ªç®€å•çš„æ³¨å†Œ/ç™»å½•é¡µé¢çš„ä»£ç æ¨¡æ¿

å…ˆç¡®ä¿ä½ å·²å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

npm install aws-amplify @aws-amplify/ui-react

é¡¹ç›®ç»“æ„å»ºè®®

src/
â”œâ”€â”€ App.js
â”œâ”€â”€ aws-config.js
â””â”€â”€ components/
    â””â”€â”€ AuthForm.js


 aws-config.jsï¼šé…ç½® Amplify
// src/aws-config.js
import { Amplify } from 'aws-amplify';

Amplify.configure({
  Auth: {
    region: 'ap-northeast-1',  // æ›¿æ¢æˆä½ è‡ªå·±çš„åŒºåŸŸ
    userPoolId: 'ap-northeast-1_xxxxxx', // æ›¿æ¢æˆä½ çš„ User Pool ID
    userPoolWebClientId: 'xxxxxxxxxxxxxxxxxxxx', // æ›¿æ¢æˆä½ çš„ App Client ID
  }
});

AuthForm.jsï¼šæ³¨å†Œ & ç™»å½•ç»„ä»¶
// src/components/AuthForm.js
import React, { useState } from 'react';
import { Auth } from 'aws-amplify';

function AuthForm() {
  const [formType, setFormType] = useState('signIn');
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [email, setEmail] = useState('');
  const [message, setMessage] = useState('');

  const signUp = async () => {
    try {
      await Auth.signUp({
        username,
        password,
        attributes: { email },
      });
      setMessage('æ³¨å†ŒæˆåŠŸï¼è¯·æŸ¥æ”¶é‚®ç®±éªŒè¯ç ã€‚');
      setFormType('signIn');
    } catch (error) {
      setMessage(error.message);
    }
  };

  const signIn = async () => {
    try {
      await Auth.signIn(username, password);
      setMessage('ç™»å½•æˆåŠŸï¼');
    } catch (error) {
      setMessage(error.message);
    }
  };

  return (
    <div style={{ maxWidth: 400, margin: 'auto' }}>
      <h2>{formType === 'signUp' ? 'ç”¨æˆ·æ³¨å†Œ' : 'ç”¨æˆ·ç™»å½•'}</h2>
      <input
        placeholder="ç”¨æˆ·å"
        value={username}
        onChange={(e) => setUsername(e.target.value)}
        style={{ width: '100%', marginBottom: 10 }}
      />
      <input
        type="password"
        placeholder="å¯†ç "
        value={password}
        onChange={(e) => setPassword(e.target.value)}
        style={{ width: '100%', marginBottom: 10 }}
      />
      {formType === 'signUp' && (
        <input
          placeholder="é‚®ç®±"
          value={email}
          onChange={(e) => setEmail(e.target.value)}
          style={{ width: '100%', marginBottom: 10 }}
        />
      )}
      <button
        onClick={formType === 'signUp' ? signUp : signIn}
        style={{ width: '100%', marginBottom: 10 }}
      >
        {formType === 'signUp' ? 'æ³¨å†Œ' : 'ç™»å½•'}
      </button>
      <p onClick={() => setFormType(formType === 'signUp' ? 'signIn' : 'signUp')} style={{ cursor: 'pointer', color: 'blue' }}>
        {formType === 'signUp' ? 'å·²æœ‰è´¦å·ï¼Ÿå»ç™»å½•' : 'æ²¡æœ‰è´¦å·ï¼Ÿå»æ³¨å†Œ'}
      </p>
      {message && <p>{message}</p>}
    </div>
  );
}

export default AuthForm;

App.jsï¼šå…¥å£æ–‡ä»¶
// src/App.js
import React from 'react';
import './aws-config';
import AuthForm from './components/AuthForm';

function App() {
  return (
    <div>
      <h1>My App</h1>
      <AuthForm />
    </div>
  );
}

export default App;

æ•ˆæœè¯´æ˜
	â€¢	ç”¨æˆ·å¯ä»¥æ³¨å†Œæ–°è´¦å·ï¼ˆç”¨æˆ·å + å¯†ç  + é‚®ç®±ï¼‰
	â€¢	æˆåŠŸåè·³è½¬åˆ°ç™»å½•ç•Œé¢
	â€¢	ç™»å½•åæ˜¾ç¤ºç™»å½•æˆåŠŸ
	â€¢	ç®€æ´åˆ‡æ¢ç™»å½•/æ³¨å†Œæ¨¡å¼
	â€¢	å¦‚éœ€é‚®ç®±éªŒè¯ç ç¡®è®¤ï¼Œå¯å¦åŠ  Auth.confirmSignUp å®ç°
























